[pytest]
# Test configuration for Transferarr

# Filter out third-party library deprecation warnings that we can't fix
filterwarnings =
    # Ignore paramiko's TripleDES deprecation warning (library issue, not our code)
    ignore:TripleDES has been moved to cryptography.hazmat.decrepit:cryptography.utils.CryptographyDeprecationWarning
    # Convert any remaining warnings to errors to catch new issues
    error::DeprecationWarning
    error::PendingDeprecationWarning

# Default test paths
testpaths = tests

# Cache directory (use test-results so it's writable in Docker)
cache_dir = test-results/.pytest_cache

# Register custom markers
markers =
    slow: marks tests as slow (catalog validation tests, deselect with '-m "not slow"')
    ui: marks tests as UI/browser tests (require Playwright and running transferarr)
    ui_slow: marks slow UI tests (full E2E workflows)

# Verbose output, exclude slow tests by default
# Playwright: screenshots on failure saved to test-results/
# Use --tracing=retain-on-failure for full debugging, --headed to see browser
addopts = -v --tb=short -m "not slow" --screenshot=only-on-failure --output=test-results
