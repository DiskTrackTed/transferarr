<!-- Authentication Tab Content -->
<div class="client-tab-content" id="auth-tab-content">
    <div class="card settings-section">
        <div class="card-body">
            <!-- Authentication Settings Section -->
            <div class="auth-settings-section">
                <h3><i class="fas fa-shield-alt"></i> Authentication Settings</h3>
                
                <div class="setting-row">
                    <div class="setting-label">
                        <label for="auth-enabled">Authentication</label>
                        <span class="setting-help">Require login to access Transferarr</span>
                    </div>
                    <div class="setting-control">
                        <label class="toggle-switch">
                            <input type="checkbox" id="auth-enabled">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>
                
                <div class="setting-row">
                    <div class="setting-label">
                        <label for="session-timeout">Session Timeout</label>
                        <span class="setting-help">How long until you need to log in again</span>
                    </div>
                    <div class="setting-control">
                        <select id="session-timeout" class="form-control">
                            <option value="30">30 minutes</option>
                            <option value="60">1 hour</option>
                            <option value="480">8 hours</option>
                            <option value="1440">24 hours</option>
                            <option value="10080">1 week</option>
                            <option value="0">Never</option>
                        </select>
                    </div>
                </div>
                
                <!-- Restart Required Warning -->
                <div class="setting-row restart-warning" id="restart-warning" style="display: none;">
                    <div class="alert alert-warning">
                        <i class="fas fa-exclamation-triangle"></i>
                        <span>Session timeout change requires a restart to take effect.</span>
                    </div>
                </div>
                
                <div class="setting-row setting-actions">
                    <button type="button" class="btn btn-primary" id="save-auth-settings">
                        <i class="fas fa-save"></i> Save Settings
                    </button>
                </div>
            </div>
            
            <!-- API Key Section -->
            <div class="auth-settings-section" id="api-key-section">
                <h3><i class="fas fa-key"></i> API Key</h3>
                <p class="section-description">Use an API key to authenticate programmatic access to the API without a user session.</p>
                
                <!-- Warning: API key exists but auth disabled -->
                <div class="alert alert-warning" id="api-key-auth-warning" style="display: none;">
                    <i class="fas fa-exclamation-triangle"></i>
                    <span>An API key exists but user authentication is disabled. The API key won't be enforced until you enable authentication above.</span>
                </div>
                
                <div class="setting-row">
                    <div class="setting-label">
                        <label for="api-key-required">Require API Key</label>
                        <span class="setting-help">Require API key for requests without a session</span>
                    </div>
                    <div class="setting-control">
                        <label class="toggle-switch">
                            <input type="checkbox" id="api-key-required">
                            <span class="toggle-slider"></span>
                        </label>
                    </div>
                </div>
                
                <div class="setting-row">
                    <div class="setting-label">
                        <label>Current API Key</label>
                        <span class="setting-help">Use this key in the X-API-Key header or ?apikey= parameter</span>
                    </div>
                    <div class="setting-control api-key-display">
                        <div class="api-key-wrapper">
                            <input type="text" id="api-key-value" class="form-control api-key-input" readonly
                                   placeholder="No API key generated">
                            <button type="button" class="btn btn-icon" id="toggle-api-key-visibility" title="Show/Hide API Key">
                                <i class="fas fa-eye"></i>
                            </button>
                            <button type="button" class="btn btn-icon" id="copy-api-key" title="Copy API Key">
                                <i class="fas fa-copy"></i>
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="setting-row setting-actions">
                    <button type="button" class="btn btn-primary" id="generate-api-key">
                        <i class="fas fa-sync-alt"></i> <span id="generate-api-key-text">Generate API Key</span>
                    </button>
                    <button type="button" class="btn btn-danger" id="revoke-api-key" style="display: none;">
                        <i class="fas fa-trash"></i> Revoke Key
                    </button>
                    <button type="button" class="btn btn-primary" id="save-api-key-settings" style="display: none;">
                        <i class="fas fa-save"></i> Save Settings
                    </button>
                </div>
            </div>
            
            <!-- Change Password Section -->
            <div class="auth-settings-section" id="change-password-section">
                <h3><i class="fas fa-lock"></i> Change Password</h3>
                
                <form id="change-password-form">
                    <div class="form-group">
                        <label for="current-password">Current Password</label>
                        <input type="password" id="current-password" class="form-control" required
                               placeholder="Enter your current password">
                    </div>
                    
                    <div class="form-group">
                        <label for="new-password">New Password</label>
                        <input type="password" id="new-password" class="form-control" required
                               minlength="8" placeholder="Enter new password (min 8 characters)">
                    </div>
                    
                    <div class="form-group">
                        <label for="confirm-new-password">Confirm New Password</label>
                        <input type="password" id="confirm-new-password" class="form-control" required
                               placeholder="Confirm your new password">
                    </div>
                    
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-lock"></i> Change Password
                        </button>
                    </div>
                </form>
            </div>
            
            <!-- Info Section when auth is disabled -->
            <div class="auth-disabled-info" id="auth-disabled-info" style="display: none;">
                <div class="alert alert-info">
                    <i class="fas fa-info-circle"></i>
                    <div>
                        <strong>Authentication is disabled</strong>
                        <p>Enable authentication above to secure your Transferarr instance with a username and password.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
